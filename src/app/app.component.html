 <div class="chunk-hydration-demo">
    <header>
        <h1>ğŸ§ª JavaScript Chunks & Incremental Hydration Demo</h1>
        <p class="subtitle">Demonstrating different loading strategies and hydration patterns</p>
    </header>

    <nav class="demo-navigation">
        <button (click)="activeDemo = 'chunks'" [class.active]="activeDemo === 'chunks'">ğŸ“¦ Chunk Loading Demo</button>
        <button (click)="activeDemo = 'hydration'" [class.active]="activeDemo === 'hydration'">ğŸ’§ Hydration Strategies</button>
        <button (click)="activeDemo = 'cart'" [class.active]="activeDemo === 'cart'">ğŸ›’ Spartacus Cart Demo</button>
        <button (click)="activeDemo = 'performance'" [class.active]="activeDemo === 'performance'">âš¡ Performance Analysis</button>
    </nav>

    <!-- Chunk Loading Demo -->
    <section *ngIf="activeDemo === 'chunks'" class="demo-section">
        <h2>ğŸ“¦ JavaScript Chunk Loading Strategies</h2>
        
        <div class="explanation">
            <h3>How Chunks Work:</h3>
            <ul>
                <li><strong>Initial Bundle:</strong> Contains essential app code loaded immediately</li>
                <li><strong>Lazy Chunks:</strong> Feature-specific code loaded on-demand</li>
                <li><strong>Vendor Chunks:</strong> Third-party libraries separated for caching</li>
            </ul>
        </div>

        <!-- Always loaded light component (immediate loading and hydration) -->
        @defer (hydrate on immediate) {
            <app-chunk-demo-light></app-chunk-demo-light>
        } @placeholder {
            <div class="ssr-placeholder">
                <h3>ğŸª¶ Light Component (SSR Rendered)</h3>
                <p>This component is server-rendered and hydrates immediately</p>
            </div>
        }
        
        <!-- Incremental hydration - component SSR rendered, hydrates on interaction -->
        @defer (hydrate on interaction) {
            <app-chunk-demo-heavy></app-chunk-demo-heavy>
        } @placeholder {
            <div class="placeholder-chunk">
                <h3>ğŸ¯ Heavy Component (Click to Hydrate)</h3>
                <p>This component is server-rendered but not yet interactive. JavaScript loads when you interact.</p>
                <div class="click-hint">ğŸ‘† Click anywhere here to hydrate and make interactive</div>
                <div class="ssr-note">Currently: SSR rendered, awaiting hydration</div>
            </div>
        }
    
    </section>

    <!-- Hydration Strategies Demo -->
    <section *ngIf="activeDemo === 'hydration'" class="demo-section">
        <h2>ğŸ’§ Hydration Strategies Comparison</h2>
        
        <div class="explanation">
            <h3>Hydration Types:</h3>
            <ul>
                <li><strong>Full Hydration:</strong> All components become interactive immediately</li>
                <li><strong>Incremental Hydration:</strong> Components hydrate only when needed</li>
                <li><strong>Selective Hydration:</strong> Only specific components are hydrated</li>
                <li><strong>Progressive Hydration:</strong> Components hydrate in priority order</li>
            </ul>
        </div>

        <!-- Full Hydration Example -->
        <div class="hydration-example">
            <h3>ğŸ”¥ Full Hydration (Traditional)</h3>
            <app-my-project></app-my-project>
        </div>

        <!-- Incremental Hydration Example -->
        <div class="hydration-example">
            <h3>ğŸ’§ Incremental Hydration (On Interaction)</h3>
            @defer (hydrate on interaction) {
                <app-chunk-demo-heavy></app-chunk-demo-heavy>
            } 
        </div>

        <!-- Viewport-based Hydration -->
        <div class="hydration-example">
            <h3>ğŸ‘ï¸ Viewport-based Hydration</h3>
            @defer (hydrate on viewport) {
                <app-chunk-demo-dynamic></app-chunk-demo-dynamic>
            } 
        </div>
        
        <!-- Timer-based Hydration -->
        <div class="hydration-example">
            <h3>â° Timer-based Hydration (3 seconds)</h3>
            @defer (hydrate on timer(3s)) {
                <app-chunk-demo-light></app-chunk-demo-light>
            }
        </div>
        
        <!-- Spartacus Cart Integration -->
        <div class="hydration-example">
            <h3>ğŸ›’ Spartacus Cart Integration (On Interaction)</h3>
            @defer (on interaction) {
                <app-custom-cart></app-custom-cart>
            } @placeholder {
                <div class="hydration-placeholder">
                    <p><strong>Spartacus Integration:</strong> Custom cart component using Spartacus services</p>
                    <button disabled>ğŸ›’ Cart Features (not interactive yet)</button>
                    <p><em>Click anywhere to load the cart component and connect to Spartacus</em></p>
                </div>
            }
        </div>
    </section>

    <!-- Spartacus Cart Demo -->
    <section *ngIf="activeDemo === 'cart'" class="demo-section">
        <h2>ğŸ›’ Spartacus Cart Integration Demo</h2>
        
        <!-- Spartacus Cart with Incremental Hydration -->
        @defer (on interaction; prefetch on interaction; hydrate on interaction) {
            <app-custom-cart></app-custom-cart>
        } @placeholder {
            <div class="placeholder-chunk">
                <h3>ğŸ›’ Interactive Spartacus Cart</h3>
                <p>This custom component integrates with Spartacus cart services and will be hydrated on interaction.</p>
                <div class="click-hint">ğŸ‘† Click here to load the cart component and connect to Spartacus services</div>
                <div class="ssr-note">Features: Add products, manage cart, view user info, performance analysis</div>
            </div>
        }
    </section>

    <!-- Performance Analysis Demo -->
    <section *ngIf="activeDemo === 'performance'" class="demo-section">
        <h2>âš¡ Performance Analysis</h2>
        
        <div class="performance-metrics">
            <h3>ğŸ“Š Current Page Metrics:</h3>
            <div class="metrics-grid">
                <div class="metric">
                    <label>ğŸ“¦ Total Scripts:</label>
                    <span>{{ performanceMetrics.totalScripts }}</span>
                </div>
                <div class="metric">
                    <label>ğŸ§© Chunk Scripts:</label>
                    <span>{{ performanceMetrics.chunkScripts }}</span>
                </div>
                <div class="metric">
                    <label>â±ï¸ Load Time:</label>
                    <span>{{ performanceMetrics.loadTime }}ms</span>
                </div>
                <div class="metric">
                    <label>ğŸ’¾ Bundle Size:</label>
                    <span>{{ performanceMetrics.bundleSize }}</span>
                </div>
            </div>
            
            <button (click)="analyzePerformance()" class="analyze-btn">ğŸ” Analyze Current Performance</button>
        </div>
         
        <div class="chunk-analysis">
            <h3>ğŸ“ˆ Chunk Loading Analysis:</h3>
            <div *ngFor="let chunk of performanceMetrics.chunks" class="chunk-item">
                <span class="chunk-name">{{ chunk.name }}</span>
                <span class="chunk-size">{{ chunk.size }}</span>
                <span class="chunk-status" [class]="chunk.status">{{ chunk.status }}</span>
            </div>
        </div>
    </section>
</div>
<cx-storefront></cx-storefront>

